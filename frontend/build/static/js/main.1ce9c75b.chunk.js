(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{104:function(e,s,t){},105:function(e,s,t){"use strict";t.r(s);var a=t(2),n=t(1),c=t.n(n),r=t(27),i=t.n(r),d=t(24),o=t(3),l=t(25),j=t(4),m=t(7),u=t(5),b=t.n(u),g=t(16),O=t(18),f=t.n(O),h="REGISTER_FAIL",p="REGISTER_SUCCESS",v="SUCCESS_MESSAGE_CLEAR",x="ERROR_CLEAR",N="USER_LOGIN_SUCCESS",y="USER_LOGIN_FAIL",I="LOGOUT_SUCCESS",S=function(){return function(){var e=Object(g.a)(b.a.mark((function e(s){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s({type:x});case 1:case"end":return e.stop()}}),e)})));return function(s){return e.apply(this,arguments)}}()},E=t(22),_=t(0),w=function(){var e=Object(m.b)(),s=Object(n.useState)({email:""}),t=Object(j.a)(s,2),c=t[0],r=t[1],i=E.d,d=Object(m.c)((function(e){return e.auth})),u=d.error,O=d.message,h=Object(o.g)();return Object(n.useEffect)((function(){u&&(console.log(u),e(S())),O&&(console.log(O),h("/"))}),[e,u,i,O]),Object(_.jsxs)("div",{className:"forgot-password",children:[Object(_.jsx)("h2",{children:"Forgot Password"}),Object(_.jsxs)("form",{className:"form-group",onSubmit:function(s){var t;s.preventDefault(),e((t=c,function(){var e=Object(g.a)(b.a.mark((function e(s){var a,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{"Content-Type":"application/json"}},e.prev=1,e.next=4,f.a.post("/api/messenger/password/forgot-password",t,a);case 4:n=e.sent,s({type:"FORGOT_PASSWORD_SUCCESS",payload:n.data.message}),console.log(n),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),s({type:"FORGOT_PASSWORD_FAIL",payload:e.t0.response.data});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(s){return e.apply(this,arguments)}}()))},action:"",children:[Object(_.jsxs)("div",{className:"form-control",children:[Object(_.jsx)("label",{htmlFor:"email",children:"Email: "}),Object(_.jsx)("input",{type:"email",className:"form-control",placeholder:"email",required:!0,name:"email",value:c.email,onChange:function(e){r(Object(a.a)(Object(a.a)({},c),{},Object(l.a)({},e.target.name,e.target.value)))}})]}),Object(_.jsx)("div",{className:"form-group",children:Object(_.jsx)("input",{type:"submit",value:"Send",className:"btn"})})]})]})};var C=function(){var e=Object(o.g)(),s=Object(m.b)(),t=Object(E.d)(),c=Object(m.c)((function(e){return e.auth})),r=(c.loading,c.authenticate),i=c.error,u=c.successMessage,O=(c.myInfo,Object(n.useState)({email:"",password:""})),h=Object(j.a)(O,2),p=h[0],I=h[1],S=function(e){I(Object(a.a)(Object(a.a)({},p),{},Object(l.a)({},e.target.name,e.target.value)))};return Object(n.useEffect)((function(){r&&e("/"),u&&(t.success(u),s({type:v})),i&&(i.map((function(e){return t.error(e)})),s({type:x}))}),[u,i]),Object(_.jsx)("div",{children:Object(_.jsx)("h1",{className:"register",children:Object(_.jsxs)("div",{className:"card",children:[Object(_.jsx)("div",{className:"card-header",children:Object(_.jsx)("h3",{children:"Login"})}),Object(_.jsx)("div",{className:"card-body",children:Object(_.jsxs)("form",{action:"",onSubmit:function(e){var t;e.preventDefault(),s((t=p,function(){var e=Object(g.a)(b.a.mark((function e(s){var a,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{"Content-Type":"application/json"}},e.prev=1,e.next=4,f.a.post("/api/messenger/user-login",t,a);case 4:n=e.sent,localStorage.setItem("authToken",n.data.token),s({type:N,payload:{successMessage:n.data.successMessage,token:n.data.token}}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),s({type:y,payload:{error:e.t0.response.data.error}});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(s){return e.apply(this,arguments)}}()))},children:[Object(_.jsxs)("div",{className:"form-group",children:[Object(_.jsx)("label",{htmlFor:"email",children:"Email"}),Object(_.jsx)("input",{type:"email",className:"form-control",placeholder:"Email",name:"email",id:"email",value:p.email,onChange:S})]}),Object(_.jsxs)("div",{className:"form-group",children:[Object(_.jsx)("label",{htmlFor:"password",children:"Password"}),Object(_.jsx)("input",{type:"password",className:"form-control",placeholder:"password",name:"password",id:"password",value:p.password,onChange:S})]}),Object(_.jsx)("div",{className:"form-group",children:Object(_.jsx)("input",{type:"submit",className:"btn",value:"login"})}),Object(_.jsx)("div",{className:"form-group",children:Object(_.jsxs)("span",{children:[" ",i&&Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(d.b,{to:"/messenger/forgot-password",children:"Forgot Password"}),Object(_.jsx)("div",{children:Object(_.jsx)(w,{})})]}),Object(_.jsx)(d.b,{to:"/messenger/register",children:"Create an Account"})," "]})})]})})]})})})},k=t(6),M=t(31),F=t.n(M),R=function(e){var s=e.friend,t=s.frndInfo,a=s.msgInfo,n=e.activeUser,c=e.myId;return Object(_.jsxs)("div",{className:"friend",children:[Object(_.jsx)("div",{className:"friend-image",children:Object(_.jsxs)("div",{className:"image",children:[Object(_.jsx)("img",{src:"./image/".concat(t.image),alt:"user"}),n&&n.length>0&&n.some((function(e){return e.userId===t._id}))?Object(_.jsx)("div",{className:"active_icon"}):""]})}),Object(_.jsxs)("div",{className:"friend-name-seen",children:[Object(_.jsxs)("div",{className:"friend-name",children:[Object(_.jsx)("h4",{className:(null===a||void 0===a?void 0:a.senderId)!==c&&void 0!==(null===a||void 0===a?void 0:a.status)&&"seen"!==a.status?"unseen_message fd_name":"fd_name",children:t.userName}),Object(_.jsxs)("div",{className:"msg-time",children:[a&&a.senderId===c?Object(_.jsx)("span",{children:"You"}):Object(_.jsx)("span",{className:(null===a||void 0===a?void 0:a.senderId)!==c&&void 0!==(null===a||void 0===a?void 0:a.status)&&"seen"!==a.status?"unseen_message ":"",children:t.userName+" "}),":",a&&a.message.text?Object(_.jsx)("span",{className:(null===a||void 0===a?void 0:a.senderId)!==c&&void 0!==(null===a||void 0===a?void 0:a.status)&&"seen"!==a.status?"unseen_message ":"",children:a.message.text.length>10?a.message.text.slice(0,10)+"...":a.message.text}):a&&a.message.image?Object(_.jsx)("span",{children:" Image sent"}):Object(_.jsx)("span",{children:"Is Connected"}),Object(_.jsx)("br",{}),Object(_.jsxs)("span",{children:[" ",F()(null===a||void 0===a?void 0:a.createdAt).startOf("minutes").fromNow()]})]})]}),c===(null===a||void 0===a?void 0:a.senderId)?Object(_.jsx)("div",{className:"seen-unseen-icon",children:"seen"===a.status?Object(_.jsx)("img",{src:"./image/".concat(t.image),alt:"user"}):"delivered"===a.status?Object(_.jsxs)("div",{className:"delivered",children:[Object(_.jsx)(k.i,{})," "]}):Object(_.jsx)("div",{className:"unseen"})}):Object(_.jsx)("div",{className:"seen-unseen-icon",children:void 0!==(null===a||void 0===a?void 0:a.status)&&"seen"!==(null===a||void 0===a?void 0:a.status)?Object(_.jsx)("div",{className:"seen-icon",children:" "}):""})]})]})},T=function(e){var s=e.currentFriend,t=e.activeUser,a=e.handleClick,n=e.message;return Object(_.jsxs)("div",{className:"friend-info",children:[Object(_.jsx)("input",{type:"checkbox",id:"gallery"}),Object(_.jsxs)("div",{className:"image-name",children:[Object(_.jsx)("div",{className:"image",children:Object(_.jsx)("img",{onClick:a,src:"/image/".concat(s.image),alt:"user"})}),t&&t.length>0&&t.some((function(e){return e.userId===s._id}))?Object(_.jsx)("div",{className:"active-user",children:"Active"}):Object(_.jsx)("div",{className:"inactive-user",children:"In-active"}),Object(_.jsx)("div",{className:"name",children:Object(_.jsx)("h4",{children:s.userName})})]}),Object(_.jsxs)("div",{className:"others",children:[Object(_.jsxs)("div",{className:"custom-chat",children:[Object(_.jsx)("h3",{children:"Customise Chat"}),Object(_.jsx)(k.a,{})]}),Object(_.jsxs)("div",{className:"privacy",children:[Object(_.jsx)("h3",{children:"Privacy and Support"}),Object(_.jsx)(k.a,{})]}),Object(_.jsxs)("div",{className:"media",children:[Object(_.jsx)("h3",{children:"Shared Media"}),Object(_.jsx)("label",{htmlFor:"gallery",children:Object(_.jsx)(k.a,{})})]})]}),Object(_.jsx)("div",{className:"gallery",children:n&&n.length>0?n.map((function(e,s){return e.message.image&&Object(_.jsx)("img",{src:"./image/".concat(e.message.image)},s)})):Object(_.jsx)("div",{className:"no-media",children:" No media "})})]})},A=function(e){var s=e.message,t=e.currentFriend,a=e.scrollRef,c=e.typingMessage,r=Object(m.c)((function(e){return e.auth})).myInfo,i=Object(n.useState)(!1),d=Object(j.a)(i,2),o=d[0],l=d[1];return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("div",{className:"message-show",children:s&&s.length>0?s.map((function(e,n){return e.senderId===r.id?Object(_.jsxs)("div",{ref:a,className:"my-message",children:[Object(_.jsx)("div",{className:"image-message",children:Object(_.jsxs)("div",{className:"my-text",children:[Object(_.jsxs)("p",{className:"message-text",children:[o&&Object(_.jsx)("img",{className:"avatar",src:"/image/".concat(e.message.image[0]),alt:""}),""===e.message.text?Object(_.jsx)("img",{onClick:function(){return l(!o)},src:"./image/".concat(e.message.image)}):e.message.text]}),n===s.length-1&&e.senderId===r.id?"seen"===e.status?Object(_.jsx)("img",{className:"img",src:"/image/".concat(t.image),alt:"user"}):"delivered"===e.status?Object(_.jsxs)("span",{children:[" ",Object(_.jsx)(k.i,{})," "]}):Object(_.jsx)("span",{children:Object(_.jsx)(k.i,{})}):""]},s._id)}),Object(_.jsx)("div",{className:"time",children:F()(e.createdAt).startOf("mini").fromNow()})]}):Object(_.jsx)("div",{className:"fd-message",ref:a,children:Object(_.jsxs)("div",{className:"image-message-time",children:[Object(_.jsx)("img",{src:"/image/".concat(t.image),alt:"user"}),Object(_.jsxs)("div",{className:"message-time",children:[Object(_.jsx)("div",{className:"fd-text",children:Object(_.jsx)("p",{className:"fd-message-text message-text",children:""===e.message.text?Object(_.jsx)("img",{src:"./image/".concat(e.message.image)}):e.message.text})}),Object(_.jsx)("div",{className:"time",children:F()(e.createdAt).startOf("mini").fromNow()})]})]})},s._id)})):Object(_.jsxs)("div",{className:"friend_connect",children:[Object(_.jsx)("img",{src:"/image/".concat(t.image),alt:"user"}),Object(_.jsxs)("h3",{children:["Connected to ",t.userName]}),Object(_.jsxs)("span",{children:[" ",F()(t.createdAt).startOf("mini").fromNow()]})]})}),c&&c.msg&&c.senderId===t._id?Object(_.jsx)("div",{className:"typing-message",children:Object(_.jsx)("div",{className:"fd-message",children:Object(_.jsxs)("div",{className:"image-message-time",children:[Object(_.jsx)("img",{src:"/image/".concat(t.image),alt:"user"}),Object(_.jsx)("div",{className:"message-time",children:Object(_.jsx)("div",{className:"fd-text",children:Object(_.jsx)("p",{className:"time",children:"Typing..."})})})]})})}):""]})},U=function(e){var s=e.inputHandle,t=e.newMessage,a=e.sendMessage,n=e.sendEmoji,c=e.sendImage;return Object(_.jsxs)("div",{className:"message-send-section",children:[Object(_.jsx)("input",{type:"checkbox",id:"emoji"}),Object(_.jsxs)("div",{className:"file hover-attachment",children:[Object(_.jsx)("div",{className:"add-attachment",children:"Add Attachment"}),Object(_.jsx)(k.h,{})]}),Object(_.jsxs)("div",{className:"file hover-image",children:[Object(_.jsx)("div",{className:"add-image",children:"Add Image"}),Object(_.jsx)("input",{type:"file",onChange:c,id:"pic",className:"form-control"}),Object(_.jsx)("label",{htmlFor:"pic",children:Object(_.jsx)(k.d,{})})]}),Object(_.jsxs)("div",{className:"file hover-gift",children:[Object(_.jsx)("div",{className:"add-gift",children:"Add gift"}),Object(_.jsx)(k.e,{})]}),Object(_.jsxs)("div",{className:"message-type",children:[Object(_.jsx)("input",{type:"text",name:"message",id:"message",placeholder:"Aa",onChange:s,className:"form-control",value:t}),Object(_.jsx)("div",{className:"file hover-gift",children:Object(_.jsxs)("label",{htmlFor:"emoji",children:[" ","\u2764\ufe0f"," "]})})]}),Object(_.jsx)("div",{onClick:a,className:"file",children:Object(_.jsx)(k.f,{})}),Object(_.jsx)("div",{className:"emoji-section",children:Object(_.jsx)("div",{className:"emoji",children:["\ud83d\ude00","\ud83d\ude04","\ud83d\ude01","\ud83d\ude06","\ud83d\ude02","\ud83e\udd23","\ud83d\ude0a","\ud83d\ude07","\ud83d\ude42","\ud83d\ude43","\ud83d\ude09","\ud83d\ude0c","\ud83d\ude0d","\ud83d\ude1d","\ud83d\ude1c","\ud83e\uddd0","\ud83e\udd13","\ud83d\ude0e","\ud83d\ude15","\ud83e\udd11","\ud83e\udd74","\ud83d\ude31"].map((function(e){return Object(_.jsx)("span",{onClick:function(){return n(e)},children:e})}))})})]})},D=function(e){var s=e.currentFriend,t=e.inputHandle,a=e.newMessage,c=e.sendMessage,r=e.message,i=e.scrollRef,d=e.sendEmoji,o=e.sendImage,l=e.activeUser,m=e.typingMessage,u=Object(n.useState)(!1),b=Object(j.a)(u,2),g=b[0],O=b[1];return Object(_.jsx)("div",{className:"col-9",children:Object(_.jsxs)("div",{className:"right-side",children:[Object(_.jsx)("input",{type:"checkbox",id:"dot"}),Object(_.jsxs)("div",{className:"row",children:[Object(_.jsxs)("div",{className:"col-8",children:[g&&Object(_.jsx)("img",{className:"avatar",src:"/image/".concat(s.image),alt:""}),Object(_.jsxs)("div",{className:"message-send-show",children:[Object(_.jsxs)("div",{className:"header",children:[Object(_.jsxs)("div",{className:"image-name",children:[Object(_.jsxs)("div",{className:"image",children:[Object(_.jsx)("img",{onClick:function(){return O(!g)},src:"/image/".concat(s.image),alt:"friendsDp"}),l&&l.length>0&&l.some((function(e){return e.userId===s._id}))?Object(_.jsx)("div",{className:"active-icon"}):Object(_.jsx)("div",{className:"inactive-icon"})]}),Object(_.jsx)("div",{className:"name",children:Object(_.jsx)("h3",{children:s.userName})})]}),Object(_.jsxs)("div",{className:"icons",children:[Object(_.jsx)("div",{className:"icon",children:Object(_.jsx)(k.g,{})}),Object(_.jsx)("div",{className:"icon",children:Object(_.jsx)(k.m,{})}),Object(_.jsx)("div",{className:"icon",children:Object(_.jsxs)("label",{htmlFor:"dot",children:[" ",Object(_.jsx)(k.j,{})]})})]})]}),Object(_.jsx)(A,{message:r,scrollRef:i,currentFriend:s,typingMessage:m}),Object(_.jsx)(U,{inputHandle:t,newMessage:a,sendMessage:c,sendEmoji:d,sendImage:o})]})]}),Object(_.jsx)("div",{className:"col-4",children:Object(_.jsx)(T,{message:r,handleClick:function(e){e.preventDefault(),O(!0),setTimeout((function(){O(!1)}),6e3)},currentFriend:s,activeUser:l})})]})]})})},L="FRIEND_GET_SUCCESS",G="GET_MESSAGE_SUCCESS",P="SEND_MESSAGE_SUCCESS",H="SOCKET_MESSAGE",B="UPDATE_FRIEND_MESSAGE",V="CLEAR_MESSAGE",X="SEEN_MESSAGE",J="DELIVERED_MESSAGE",W="UPDATE",q="SEEN_ALL",z="GET_THEME_SUCCESS",K="SET_THEME_SUCCESS",Y=function(e){return function(){var s=Object(g.a)(b.a.mark((function s(t){var a;return b.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,f.a.post("/api/messenger/seen-message",e);case 3:a=s.sent,console.log(a.data),s.next=10;break;case 7:s.prev=7,s.t0=s.catch(0),console.log(s.t0.response.message);case 10:case"end":return s.stop()}}),s,null,[[0,7]])})));return function(e){return s.apply(this,arguments)}}()},Q=function(e){return function(){var s=Object(g.a)(b.a.mark((function s(t){return b.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:localStorage.setItem("theme",e),t({type:K,payload:{theme:e}});case 2:case"end":return s.stop()}}),s)})));return function(e){return s.apply(this,arguments)}}()},Z=t(66),$=t(49),ee=t(48),se=t.p+"static/media/notification.38a85dc7.mp3",te=t.p+"static/media/sending.bbed80de.mp3",ae=function(){var e=Object(ee.a)(se),s=Object(j.a)(e,1)[0],t=Object(ee.a)(te),a=Object(j.a)(t,1)[0],c=Object(n.useRef)(),r=Object(n.useRef)(),i=Object(n.useState)(""),d=Object(j.a)(i,2),o=d[0],l=d[1],u=Object(n.useState)(!0),O=Object(j.a)(u,2),h=O[0],p=O[1],v=Object(n.useState)(""),x=Object(j.a)(v,2),N=x[0],y=x[1],S=Object(n.useState)(""),E=Object(j.a)(S,2),w=E[0],C=E[1],M=Object(n.useState)(""),F=Object(j.a)(M,2),T=F[0],A=F[1],U=Object(n.useState)([]),K=Object(j.a)(U,2),ae=K[0],ne=K[1],ce=Object(n.useState)(),re=Object(j.a)(ce,2),ie=(re[0],re[1],Object(m.c)((function(e){return e.messenger}))),de=ie.friends,oe=ie.message,le=ie.messageSendSuccess,je=ie.message_get_success,me=ie.themeMode;console.log(de,oe,le,je,me);var ue=Object(m.c)((function(e){return e.auth})).myInfo,be=Object(m.b)();Object(n.useEffect)((function(){r.current=Object(Z.a)("ws://localhost:8000"),r.current.on("getMessage",(function(e){C(e)})),r.current.on("getTypingMessage",(function(e){A(e)})),r.current.on("msgSeenResponse",(function(e){be({type:X,payload:{msgInfo:e}})})),r.current.on("msgDeliveredResponse",(function(e){be({type:J,payload:{msgInfo:e}})})),r.current.on("seenSuccess",(function(e){be({type:q,payload:e})}))}),[]),Object(n.useEffect)((function(){w&&o&&w.senderId===o._id&&w.receiverId===ue.id&&(be({type:H,payload:{message:w}}),be(Y(w)),r.current.emit("messageSeen",w),be({type:B,payload:{msgInfo:w,status:"seen"}})),C("")}),[w]),Object(n.useEffect)((function(){r.current.emit("addUser",ue.id,ue)}),[]),Object(n.useEffect)((function(){r.current.on("getUser",(function(e){var s=e.filter((function(e){return e.userId!==ue.id}));ne(s)}))}),[]),Object(n.useEffect)((function(){var e;w&&w.senderId!==o._id&&w.receiverId===ue.id&&(s(),$.b.success("".concat(w.senderName," sent a new Message")),be((e=w,function(){var s=Object(g.a)(b.a.mark((function s(t){var a;return b.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,f.a.put("/api/messenger/delivered-message",e);case 3:a=s.sent,console.log(a.data),s.next=10;break;case 7:s.prev=7,s.t0=s.catch(0),console.log(s.t0.response.message);case 10:case"end":return s.stop()}}),s,null,[[0,7]])})));return function(e){return s.apply(this,arguments)}}())),r.current.emit("deliveredMessage",w),be({type:B,payload:{msgInfo:w,status:"delivered"}}))}),[w]);Object(n.useEffect)((function(){le&&(r.current.emit("sendMessage",oe[oe.length-1]),be({type:B,payload:{msgInfo:oe[oe.length-1]}}),be({type:V}))}),[le]),Object(n.useEffect)((function(){be(function(){var e=Object(g.a)(b.a.mark((function e(s){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.get("/api/messenger/get-friends");case 3:t=e.sent,s({type:L,payload:{friends:t.data.friends}}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(s){return e.apply(this,arguments)}}())}),[]),Object(n.useEffect)((function(){de&&(null===de||void 0===de?void 0:de.length)>0&&l(de[0].frndInfo)}),[de]),Object(n.useEffect)((function(){var e;be((e=o._id,function(){var s=Object(g.a)(b.a.mark((function s(t){var a;return b.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,f.a.get("/api/messenger/get-message/".concat(e));case 3:a=s.sent,t({type:G,payload:{message:a.data.message}}),s.next=10;break;case 7:s.prev=7,s.t0=s.catch(0),console.log(s.t0.response.data);case 10:case"end":return s.stop()}}),s,null,[[0,7]])})));return function(e){return s.apply(this,arguments)}}())),null===de||void 0===de||de.length}),[null===o||void 0===o?void 0:o._id]),Object(n.useEffect)((function(){(null===oe||void 0===oe?void 0:oe.length)>0&&oe[oe.length-1].senderId!==ue.id&&"seen"!==oe[oe.length-1].status&&(be({type:W,payload:{id:o._id}}),r.current.emit("seen",{senderId:o._id,receiverId:ue.id}),be(Y({_id:oe[oe.length-1]._id}))),be({type:V})}),[je,o._id,be,oe,ue.id]),Object(n.useEffect)((function(){var e;null===(e=c.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[oe]);Object(n.useEffect)((function(){be(function(){var e=Object(g.a)(b.a.mark((function e(s){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=localStorage.getItem("theme"),s({type:z,payload:{theme:t||"white"}});case 2:case"end":return e.stop()}}),e)})));return function(s){return e.apply(this,arguments)}}())}),[]);return Object(_.jsxs)("div",{className:"dark"===me?"messenger theme":"messenger",children:[Object(_.jsx)($.a,{position:"top-right",reverseOrder:!1,toastOptions:{style:{fontSize:"18px"}}}),Object(_.jsxs)("div",{className:"row",children:[Object(_.jsx)("div",{className:"col-3",children:Object(_.jsxs)("div",{className:"left-side",children:[Object(_.jsxs)("div",{className:"top",children:[Object(_.jsxs)("div",{className:"image-name",children:[Object(_.jsx)("div",{className:"image",children:Object(_.jsx)("img",{src:"/image/".concat(ue.image),alt:"user"})}),Object(_.jsxs)("div",{className:"name",children:[Object(_.jsxs)("h3",{children:["Hi ",ue.userName]})," "]})]}),Object(_.jsxs)("div",{className:"icons",children:[Object(_.jsx)("div",{onClick:function(){return p(!h)},className:"icon",children:Object(_.jsx)(k.c,{})}),Object(_.jsx)("div",{className:"icon",children:Object(_.jsx)(k.b,{})}),Object(_.jsxs)("div",{className:h?"theme_logout":"theme_logout show",children:[Object(_.jsx)("h3",{children:"Dark Mode"}),Object(_.jsxs)("div",{className:"on",children:[Object(_.jsx)("label",{htmlFor:"dark",children:"ON"}),Object(_.jsx)("input",{onChange:function(e){return be(Q(e.target.value))},type:"radio",name:"theme",value:"dark",id:"dark"})]}),Object(_.jsxs)("div",{className:"off",children:[Object(_.jsx)("label",{htmlFor:"white",children:"OFF"}),Object(_.jsx)("input",{onChange:function(e){return be(Q(e.target.value))},type:"radio",name:"theme",value:"white",id:"white"})]}),Object(_.jsxs)("div",{onClick:function(){be(function(){var e=Object(g.a)(b.a.mark((function e(s){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.post("/api/messenger/user-logout");case 3:e.sent.data.success&&(localStorage.removeItem("authToken"),s({type:I})),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(s){return e.apply(this,arguments)}}()),r.current.emit("logout",ue.id)},className:"logout",children:[Object(_.jsx)(k.k,{})," Logout"]})]})]})]}),Object(_.jsx)("div",{className:"friend-search",children:Object(_.jsxs)("div",{className:"search",children:[Object(_.jsxs)("button",{children:[Object(_.jsx)(k.l,{})," "]}),Object(_.jsx)("input",{onChange:function(e){for(var s=document.getElementsByClassName("hover-friend"),t=document.getElementsByClassName("fd_name"),a=0;s.length,a<t.length;a++){t[a].innerText.toLowerCase().indexOf(e.target.value.toLowerCase())>-1?s[a].style.display="":s[a].style.display="none"}},type:"text",placeholder:"Search",className:"form-control"})]})}),Object(_.jsx)("div",{className:"friends",children:de&&de.length>0?de.map((function(e){return Object(_.jsx)("div",{onClick:function(){return l(e.frndInfo)},className:o._id===e.frndInfo._id?"hover-friend active":"hover-friend",children:Object(_.jsx)(R,{activeUser:ae,myId:ue.id,friend:e})})})):"No Friends"})]})}),o?Object(_.jsx)(D,{message:oe,currentFriend:o,inputHandle:function(e){y(e.target.value),r.current.emit("typingMessage",{senderId:ue.id,receiverId:o._id,msg:e.target.value})},newMessage:N,sendMessage:function(e){e.preventDefault(),a();var s={senderName:ue.userName,receiverId:o._id,message:N||"\u2764\ufe0f"};r.current.emit("typingMessage",{senderId:ue.id,receiverId:o._id,msg:""}),be(function(e){return function(){var s=Object(g.a)(b.a.mark((function s(t){var a;return b.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,f.a.post("/api/messenger/send-message",e);case 3:a=s.sent,t({type:P,payload:{message:a.data.message}}),s.next=9;break;case 7:s.prev=7,s.t0=s.catch(0);case 9:case"end":return s.stop()}}),s,null,[[0,7]])})));return function(e){return s.apply(this,arguments)}}()}(s)),y("")},scrollRef:c,sendEmoji:function(e){y("".concat(N)+e),r.current.emit("typingMessage",{senderId:ue.id,receiverId:o._id,msg:e})},sendImage:function(e){if(0!==e.target.files.length){a();var s=e.target.files[0].name,t=Date.now()+s;r.current.emit("sendMessage",{senderId:ue.id,senderName:ue.userName,receiverId:o._id,time:new Date,message:{text:N||"",image:t}});var n=new FormData;n.append("senderName",ue.userName),n.append("imageName",t),n.append("receiverId",o._id),n.append("image",e.target.files[0]),be((c=n,function(){var e=Object(g.a)(b.a.mark((function e(s){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.post("/api/messenger/send-image-message",c);case 3:t=e.sent,s({type:P,payload:{message:t.data.message}}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0.response.data);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(s){return e.apply(this,arguments)}}()))}var c},activeUser:ae,typingMessage:T}):"Select a friend"]})]})},ne=function(e){var s=e.children;return Object(m.c)((function(e){return e.auth})).authenticate?s:Object(_.jsx)(o.a,{to:"/messenger/login"})},ce=function(){var e=Object(o.g)(),s=Object(E.d)(),t=Object(m.c)((function(e){return e.auth})),c=(t.loading,t.authenticate),r=t.error,i=t.successMessage,u=(t.myInfo,Object(m.b)()),O=Object(n.useState)({userName:"",email:"",password:"",confirmPassword:"",image:""}),N=Object(j.a)(O,2),y=N[0],I=N[1],S=Object(n.useState)(""),w=Object(j.a)(S,2),C=w[0],k=w[1],M=function(e){I(Object(a.a)(Object(a.a)({},y),{},Object(l.a)({},e.target.name,e.target.value)))};return Object(n.useEffect)((function(){c&&e("/"),i&&(s.success(i),u({type:v})),r&&(r.map((function(e){return s.error(e)})),u({type:x}))}),[i,r]),Object(_.jsx)("div",{children:Object(_.jsx)("h1",{className:"register",children:Object(_.jsxs)("div",{className:"card",children:[Object(_.jsx)("div",{className:"card-header",children:Object(_.jsx)("h3",{children:"Register"})}),Object(_.jsx)("div",{className:"card-body",children:Object(_.jsxs)("form",{onSubmit:function(e){var s=y.userName,t=y.email,a=y.password,n=y.confirmPassword,c=y.image;e.preventDefault();var r,i=new FormData;i.append("userName",s),i.append("email",t),i.append("password",a),i.append("confirmPassword",n),i.append("image",c),u((r=i,function(){var e=Object(g.a)(b.a.mark((function e(s){var t,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={headers:{"Content-Type":"application/json"}},e.prev=1,e.next=4,f.a.post("/api/messenger/user-register",r,t);case 4:a=e.sent,localStorage.setItem("authToken",a.data.token),s({type:p,payload:{successMessage:a.data.successMessage,token:a.data.token}}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),s({type:h,payload:{error:e.t0.response.data.error.errorMessage}});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(s){return e.apply(this,arguments)}}()))},action:"",children:[Object(_.jsxs)("div",{className:"form-group",children:[Object(_.jsx)("label",{htmlFor:"username",children:"Username"}),Object(_.jsx)("input",{onChange:M,name:"userName",value:y.userName,type:"text",className:"form-control",placeholder:"Username",id:"username"})]}),Object(_.jsxs)("div",{className:"form-group",children:[Object(_.jsx)("label",{htmlFor:"email",children:"Email"}),Object(_.jsx)("input",{onChange:M,name:"email",value:y.email,type:"email",className:"form-control",placeholder:"Email",id:"email"})]}),Object(_.jsxs)("div",{className:"form-group",children:[Object(_.jsx)("label",{htmlFor:"password",children:"Password"}),Object(_.jsx)("input",{onChange:M,name:"password",value:y.password,type:"password",className:"form-control",placeholder:"password",id:"password"})]}),Object(_.jsxs)("div",{className:"form-group",children:[Object(_.jsx)("label",{htmlFor:"confirmPassword",children:"Confirm Password"}),Object(_.jsx)("input",{onChange:M,name:"confirmPassword",value:y.confirmPassword,type:"password",className:"form-control",placeholder:"Confirm password",id:"confirmPassword"})]}),Object(_.jsx)("div",{className:"form-group",children:Object(_.jsxs)("div",{className:"file-image",children:[Object(_.jsx)("div",{className:"image",children:C?Object(_.jsx)("img",{src:C}):""}),Object(_.jsxs)("div",{className:"file",children:[Object(_.jsx)("label",{htmlFor:"image",children:"Select Image"}),Object(_.jsx)("input",{onChange:function(e){0!==e.target.files.length&&I(Object(a.a)(Object(a.a)({},y),{},Object(l.a)({},e.target.name,e.target.files[0])));var s=new FileReader;s.onload=function(){k(s.result)},s.readAsDataURL(e.target.files[0])},name:"image",type:"file",className:"form-control",id:"image"})]})]})}),Object(_.jsx)("div",{className:"form-group",children:Object(_.jsx)("input",{type:"submit",className:"btn",value:"register"})}),Object(_.jsx)("div",{className:"form-group",children:Object(_.jsxs)("span",{children:[" ",Object(_.jsx)(d.b,{to:"/messenger/login",children:"Login"})," "]})})]})})]})})})};var re=function(){return Object(_.jsx)("div",{children:Object(_.jsx)(d.a,{children:Object(_.jsxs)(o.d,{children:[Object(_.jsx)(o.b,{path:"/messenger/login",element:Object(_.jsx)(C,{})}),Object(_.jsx)(o.b,{path:"/messenger/register",element:Object(_.jsx)(ce,{})}),Object(_.jsx)(o.b,{path:"/",element:Object(_.jsxs)(ne,{children:[" ",Object(_.jsx)(ae,{})]})})]})})})},ie=(t(104),t(40)),de=t(64),oe=t(63),le={loading:!0,authenticate:!1,error:"",successMessage:"",myInfo:"",message:""},je=function(e){var s=Object(oe.a)(e),t=new Date(1e3*s.exp);return new Date>t?null:s},me=localStorage.getItem("authToken");if(me){var ue=je(me);ue&&(le.myInfo=ue,le.authenticate=!0,le.loading=!1)}console.log(me);var be=t(39),ge={friends:[],message:[],messageSendSuccess:!1,message_get_success:!1,themeMode:""},Oe=Object(ie.b)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le,s=arguments.length>1?arguments[1]:void 0,t=s.payload,n=s.type;if(n===h||n===y)return Object(a.a)(Object(a.a)({},e),{},{error:t.error,authenticate:!1,myInfo:"",loading:!0});if(n===p||n===N){var c=je(t.token);return Object(a.a)(Object(a.a)({},e),{},{myInfo:c,successMessage:t.successMessage,error:"",authenticate:!0,loading:!1})}return n===v?Object(a.a)(Object(a.a)({},e),{},{successMessage:""}):n===x?Object(a.a)(Object(a.a)({},e),{},{error:""}):"LOGOUT_SUCCESS"===n?Object(a.a)(Object(a.a)({},e),{},{authenticate:!1,myInfo:"",successMessage:"Logout Successfull"}):e},messenger:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ge,s=arguments.length>1?arguments[1]:void 0,t=s.type,n=s.payload;if(t===z||t===K)return Object(a.a)(Object(a.a)({},e),{},{themeMode:n.theme});if(t===L)return Object(a.a)(Object(a.a)({},e),{},{friends:n.friends});if(t===G)return Object(a.a)(Object(a.a)({},e),{},{message_get_success:!0,message:n.message});if(t===P)return Object(a.a)(Object(a.a)({},e),{},{messageSendSuccess:!0,message:[].concat(Object(be.a)(e.message),[n.message])});if(t===H)return Object(a.a)(Object(a.a)({},e),{},{message:[].concat(Object(be.a)(e.message),[n.message])});if(t===B){var c=e.friends.findIndex((function(e){return e.frndInfo._id===n.msgInfo.receiverId||e.frndInfo._id===n.msgInfo.senderId}));return e.friends[c].msgInfo=n.msgInfo,e.friends[c].msgInfo.status=n.status,e}if(t===V)return Object(a.a)(Object(a.a)({},e),{},{messageSendSuccess:!1,message_get_success:!1});if(t===X){var r=e.friends.findIndex((function(e){return e.frndInfo._id===n.msgInfo.receiverId||e.frndInfo._id===n.msgInfo.senderId}));return e.friends[r].msgInfo.status="seen",Object(a.a)({},e)}if(t===J){var i=e.friends.findIndex((function(e){return e.frndInfo._id===n.msgInfo.receiverId||e.frndInfo._id===n.msgInfo.senderId}));return e.friends[i].msgInfo.status="delivered",Object(a.a)({},e)}if(t===W){var d=e.friends.findIndex((function(e){return e.frndInfo._id===n.id}));return e.friends[d].msgInfo&&(e.friends[d].msgInfo.status="seen"),Object(a.a)({},e)}if(t===q){var o=e.friends.findIndex((function(e){return e.frndInfo._id===n.receiverId}));return e.friends[o].msgInfo.status="seen",Object(a.a)({},e)}return t===I?Object(a.a)(Object(a.a)({},e),{},{friends:[],message:[],messageSendSuccess:!1,message_get_success:!1}):e}}),fe=[de.a],he=Object(ie.d)(Oe,Object(ie.c)(ie.a.apply(void 0,fe),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())),pe=t(65),ve={timeout:5e3,positions:E.b.BOTTOM_CENTER,transitions:E.c.SCALE};i.a.render(Object(_.jsx)(c.a.StrictMode,{children:Object(_.jsx)(m.a,{store:he,children:Object(_.jsx)(E.a,Object(a.a)(Object(a.a)({template:pe.a},ve),{},{children:Object(_.jsx)(re,{})}))})}),document.getElementById("root"))}},[[105,1,2]]]);
//# sourceMappingURL=main.1ce9c75b.chunk.js.map